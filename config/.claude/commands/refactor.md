Refactor this code to improve:
- Code organization and structure
- Readability and maintainability  
- Separation of concerns
- DRY principles (Don't Repeat Yourself)
- Follow established patterns in the codebase